<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>todo list mvc</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
</head>
<body>
<div class="wrapper">
    <input type="text" id="Input">
    <ul id="List">
        <li>
            <p>First thing</p>
            <button>X</button>
        </li>
        <li>
            <p>The second thing</p>
            <button>X</button>
        </li>
    </ul>
</div>
<style>
    .wrapper{
        padding: 20px;
        max-width: 300px;
        margin:0 auto;
        background-color: antiquewhite
    }
    #Input{
        width:100%;
    }

    #List li{
        -webkit-transition-property:all;
        transition-property:all;
        -webkit-transition-duration:300ms;
        transition-duration:300ms;
        -webkit-transform:translate3d(0px, -10px, 0px);
        transform:translate3d(0px, -10px, 0px);
        opacity: 0;
    }

    #List li p{
        display: inline
    }

    #List li button{
        float: right
    }
</style>
<script type="text/javascript" src="../dingdingH5.js"></script>
<script>
    ddH5.Page({
        onload:function(){
            var a = List.children;
            for(let i=0;i<a.length;i++){
                a[i].style.opacity="1";
                a[i].style.webkitTransform=`translate3d(0px, 0px, 0px)`;
                a[i].style.transform=`translate3d(0px, 0px, 0px)`;
            }
        }
    });



    // List.addEventListener('click',function(event){
    //     var ev = event||window.event;
    //     var target = ev.target||ev.srcElement;
    //     if(target.nodeName.toLowerCase() == 'button'){
    //         /**
    //          * [get-child-node-index]
    //          * (https://stackoverflow.com/questions/5913927/get-child-node-index)
    //          * **/
    //         var _index = Array.prototype.indexOf.call(target.parentNode.parentNode.children, target.parentNode);
    //         less(_index)
    //     }
    // });

    Input.onkeypress = function(e){
        var keyCode = null;

        if(e.which)
            keyCode = e.which;
        else if(e.keyCode)
            keyCode = e.keyCode;

        if(keyCode == 13) {
            add(Input.value);
            Input.value = null;
            Input.blur();
            return false;
        }
        return true;
    };

    function add(value){
        var li=document.createElement("li");
        li.innerHTML = `
            <p>${value}</p>
            <button>X</button>
        `
        List.appendChild(li);
        setTimeout(function(){
            li.style.webkitTransform=`translate3d(0px, 0px, 0px)`;
            li.style.transform=`translate3d(0px, 0px, 0px)`;
            li.style.opacity="1";
        },0)
    }

    function less(index){
        List.removeChild(List.children[index])
    }

    var Controller = function(options){
        this.view = options.view;
        this.events = options.events;
        options.events.initial.apply(this)
        // for(let i in options.created){
        //     options.created[i].apply(this)
        // }
        // for(let i in options.events){
        //     options.events[i].bind(this)
        // }
    };
    new Controller({
        // model : new Model(),
        view: List,
        events:{
            initial:function(){
                console.log(this)
                this.view.addEventListener('click',function(event){
                    var ev = event||window.event;
                    var target = ev.target||ev.srcElement;
                    if(target.nodeName.toLowerCase() == 'button'){
                        /**
                         * [get-child-node-index]
                         * (https://stackoverflow.com/questions/5913927/get-child-node-index)
                         * **/
                        var _index = Array.prototype.indexOf.call(target.parentNode.parentNode.children, target.parentNode);
                        this.less(_index)
                    }
                }.bind(this));
            },
            add:function(value){
                var li=document.createElement("li");
                li.innerHTML = `
                    <p>${value}</p>
                    <button>X</button>
                `
                this.view.appendChild(li);
                setTimeout(function(){
                    li.style.webkitTransform=`translate3d(0px, 0px, 0px)`;
                    li.style.transform=`translate3d(0px, 0px, 0px)`;
                    li.style.opacity="1";
                },0)
            },
            less:function(index){
                console.log(this)
                this.view.removeChild(this.view.children[index])
            }
        }
    })

</script>
<!--MVC实现

    Input/button 发送事件

    List 响应事件

    //响应Controller，发送给View
    var Model = function(){}
    Model.prototype.set=function(){}
    Model.prototype.get=function(){}

    var model1 = new Model()

    //监听View的事件，发送给Model
    var Controller = {

        model:model1,

        view:{

        },

        events:{

        }
    }


    //data
    listData=[]

 -->
</body>
</html>
